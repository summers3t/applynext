import"../chunks/Bzak7iHL.js";import"../chunks/CYsr-paj.js";import{p as oa,a9 as he,aa as la,f as S,s as r,a as ft,b as m,c as ua,i as e,m as g,j as t,d,r as u,t as C,u as c,e as xe,ab as Gt,ac as Se}from"../chunks/BAKKtip-.js";import{g as da,s as st,e as _}from"../chunks/C9sUR3Xw.js";import{i as P}from"../chunks/B8FQCOyo.js";import{e as Ie,s as Ft,p as Ht,i as Te}from"../chunks/BwJYG__W.js";import{s as re,r as Z,b as $}from"../chunks/fZbFrnr1.js";import{s as De,a as qe,b as Jt}from"../chunks/KN7HCD86.js";import{b as Kt}from"../chunks/CbCBvXji.js";import{i as ca}from"../chunks/VeT9vhzU.js";import{s as pa,a as va,b as _a}from"../chunks/DrU4zZF5.js";import{s as nt}from"../chunks/Dew1yWqH.js";import{s as Zt}from"../chunks/DIGPD2v9.js";var ba=S("<p>Loading...</p>"),fa=S('<p style="color:red;"> </p>'),ma=S("<p>No tasks yet.</p>"),ga=S('<button class="expander svelte-1d8c2g"> </button>'),ya=S('<button type="button" style="margin-right:0.3em;">❌</button>'),ka=S('<td colspan="3" class="edit-form-row svelte-1d8c2g"><form style="display:flex;align-items:center;gap:0.7em;"><input type="text" required style="width:28%;"/> <input type="text" placeholder="Description (optional)" style="width:38%;"/> <select><option>Open</option><option>In Progress</option><option>Done</option></select> <input type="date" style="width:25%;"/> <!> <button type="submit">Save</button> <button type="button">Cancel</button></form></td>'),wa=S('<td class="svelte-1d8c2g"> </td> <td class="svelte-1d8c2g"> </td> <td class="date-cell svelte-1d8c2g"><!></td>',1),ha=S('<button type="button" style="margin-right:0.3em;">❌</button>'),xa=S('<tr class="insert-form-row svelte-1d8c2g"><td colspan="5" class="svelte-1d8c2g"><form><input type="text" placeholder="Task title" required style="margin-right:0.5em; width:25%;"/> <input type="text" placeholder="Description (optional)" style="margin-right:0.5em; width:35%;"/> <select style="margin-right:0.5em;"><option>Open</option><option>In Progress</option><option>Done</option></select> <input type="date" style="margin-right:0.5em;"/> <!> <button type="submit"> </button> <button type="button">Cancel</button></form></td></tr>'),Sa=S('<button type="button" style="margin-right:0.3em;">❌</button>'),Ia=S('<td colspan="3" class="subtask-edit-row svelte-1d8c2g"><form style="display:flex;align-items:center;gap:0.7em;"><input type="text" required style="width:38%;"/> <select><option>Open</option><option>In Progress</option><option>Done</option></select> <input type="date" style="width:25%;"/> <!> <button type="submit">Save</button> <button type="button">Cancel</button></form></td>'),Ta=S('<td class="svelte-1d8c2g"></td> <td class="svelte-1d8c2g"> </td> <td class="date-cell svelte-1d8c2g"><!></td>',1),Da=S('<button type="button" style="margin-right:0.3em;">❌</button>'),qa=S('<tr class="subtask-insert-row svelte-1d8c2g"><td colspan="5" class="svelte-1d8c2g"><form><input type="text" placeholder="Subtask content" required style="margin-right:0.5em; width:32%;"/> <select style="margin-right:0.5em;"><option>Open</option><option>In Progress</option><option>Done</option></select> <input type="date" style="margin-right:0.5em;"/> <!> <button type="submit"> </button> <button type="button">Cancel</button></form></td></tr>'),Ea=S('<tr style="cursor:pointer;"><td class="svelte-1d8c2g"><span class="subtask-indent svelte-1d8c2g"></span></td><td class="svelte-1d8c2g"><span class="status-dot svelte-1d8c2g"></span></td><!></tr> <!>',1),Oa=S('<button type="button" style="margin-right:0.3em;">❌</button>'),Ca=S('<tr class="subtask-insert-row svelte-1d8c2g"><td colspan="5" class="svelte-1d8c2g"><form><input type="text" placeholder="Subtask content" required style="margin-right:0.5em; width:32%;"/> <select style="margin-right:0.5em;"><option>Open</option><option>In Progress</option><option>Done</option></select> <input type="date" style="margin-right:0.5em;"/> <!> <button type="submit"> </button> <button type="button">Cancel</button></form></td></tr>'),Aa=S("<!> <!>",1),Pa=S('<tr style="cursor:pointer;"><td class="svelte-1d8c2g"><!></td><td class="svelte-1d8c2g"><span class="status-dot svelte-1d8c2g"></span></td><!></tr> <!> <!>',1),Fa=S('<table class="task-table svelte-1d8c2g"><thead><tr><th style="width:3em;" class="svelte-1d8c2g"></th><th style="width:2em;" class="svelte-1d8c2g"></th><th style="width:40%;" class="svelte-1d8c2g">Task</th><th style="width:35%;" class="svelte-1d8c2g">Description / Subtask</th><th class="date-cell svelte-1d8c2g">Due Date</th></tr></thead><tbody></tbody></table>'),Na=S('<p> </p> <h2>Your Tasks</h2> <div class="action-toolbar svelte-1d8c2g"><button class="toolbar-btn svelte-1d8c2g">Insert</button> <button class="toolbar-btn svelte-1d8c2g">Add Subtask</button> <button class="toolbar-btn svelte-1d8c2g">↑</button> <button class="toolbar-btn svelte-1d8c2g">↓</button> <button class="toolbar-btn svelte-1d8c2g">Edit</button> <button class="toolbar-btn delete-btn svelte-1d8c2g">Delete</button></div> <!>',1),Wa=S("<p>Not signed in</p>"),La=S("<h1>Welcome to ApplyNext</h1> <!>",1);function Xa(Ee,It){oa(It,!1);const[Oe,Ce]=pa(),E=()=>va(Zt,"$session",Oe),Ae={open:"#fff",in_progress:"#1976d2",done:"#43a047"},$t="#e74c3c";let v=g([]),Nt=g(!1),Qt=g(""),dt=g(""),Tt=g(""),wt=g("open"),mt=g(null),Dt=g(!1),rt=g(null),a=g(null),k=g(null),gt=g(""),Wt=g(""),qt=g("open"),ht=g(null),Lt=g(!1),F=g(null),R=g(""),it=g("open"),V=g(null),ct=g(!1),w=g(null),yt=g(""),Et=g("open"),xt=g(null),Yt=g(!1),M=g(new Set);function ie(s){if(!s)return"";const n=s.slice(0,10).split("-");return n.length!==3?s:`${n[2]}.${n[1]}.${n[0]}`}function Ot(s,n){if(!s||n==="done")return!1;const i=new Date;return new Date(s)<new Date(i.getFullYear(),i.getMonth(),i.getDate())}function oe(s,n){return n?$t:Ae[s]}async function tt(){if(e(Nt,!0),e(Qt,""),!E()){e(v,[]),e(Nt,!1);return}const{data:s,error:n}=await nt.from("tasks").select("*, subtasks(*)").eq("owner_id",E().user.id).order("sort_index",{ascending:!0});if(n){e(Qt,n.message),e(v,[]),e(Nt,!1);return}e(v,(s??[]).map(i=>{const p=Array.isArray(i.subtasks)?i.subtasks.map(y=>({...y,sort_index:y.sort_index??0})):[];return{...i,subtasks:p.sort((y,I)=>y.sort_index-I.sort_index)}})),e(Nt,!1),e(a,null),e(rt,null),e(k,null),e(F,null),e(w,null),e(M,new Set([...t(M)].filter(i=>t(v).some(p=>p.id===i&&p.subtasks.length>0))))}async function te(s){await Promise.all(s.map((n,i)=>nt.from("tasks").update({sort_index:i}).eq("id",n.id))),await tt()}async function ee(s,n){await Promise.all(n.map((i,p)=>nt.from("subtasks").update({sort_index:p}).eq("id",i.id))),await tt()}async function Pe(s=null){if(!t(dt).trim()||!E())return;e(Dt,!0);let n=t(v).length;if(s!==null){n=s+1;const i=t(v).slice(0,n),p=t(v).slice(n),{data:y,error:I}=await nt.from("tasks").insert([{title:t(dt).trim(),description:t(Tt).trim(),status:t(wt),due_date:t(mt),owner_id:E().user.id,sort_index:n}]).select("*, subtasks(*)");if(e(Dt,!1),I||!y||!y[0]){alert("Error creating task: "+((I==null?void 0:I.message)??"unknown")),await tt();return}const W=y[0],ot=[...i,W,...p];await te(ot)}else{const{data:i,error:p}=await nt.from("tasks").insert([{title:t(dt).trim(),description:t(Tt).trim(),status:t(wt),due_date:t(mt),owner_id:E().user.id,sort_index:n}]).select("*, subtasks(*)");if(e(Dt,!1),p||!i||!i[0]){alert("Error creating task: "+((p==null?void 0:p.message)??"unknown")),await tt();return}await tt()}e(dt,""),e(Tt,""),e(wt,"open"),e(mt,null),e(rt,null)}function Fe(s){e(rt,s),e(dt,""),e(Tt,""),e(wt,"open"),e(mt,null),e(k,null),e(w,null),e(F,null)}async function le(s){if(!t(a)||t(a).type!=="task")return;const n=t(v).findIndex(I=>{var W;return I.id===((W=t(a))==null?void 0:W.id)});if(n===-1)return;const i=n+s;if(i<0||i>=t(v).length)return;const p=[...t(v)],[y]=p.splice(n,1);p.splice(i,0,y),await te(p),e(a,{type:"task",id:y.id})}async function Ne(){if(t(a)){if(t(a).type==="task"){await nt.from("tasks").delete().eq("id",t(a).id).eq("owner_id",E().user.id);const s=t(v).filter(n=>n.id!==t(a).id);await te(s),e(a,null)}else if(t(a).type==="subtask"&&t(a).parentTaskId){const s=t(v).find(i=>i.id===t(a).parentTaskId);if(!s)return;await nt.from("subtasks").delete().eq("id",t(a).id).eq("owner_id",E().user.id);const n=s.subtasks.filter(i=>i.id!==t(a).id);await ee(s.id,n),e(a,null)}}}function We(s){e(a,{type:"task",id:s}),e(rt,null),e(k,null),e(F,null),e(w,null)}function Le(s,n){e(a,{type:"subtask",id:s,parentTaskId:n}),e(rt,null),e(k,null),e(F,null),e(w,null)}function Ye(){if(t(a)){if(t(a).type==="task"){const s=t(v).find(n=>{var i;return n.id===((i=t(a))==null?void 0:i.id)});if(!s)return;e(k,s.id),e(gt,s.title),e(Wt,s.description??""),e(qt,s.status),e(ht,s.due_date),e(rt,null),e(F,null),e(w,null)}else if(t(a).type==="subtask"&&t(a).parentTaskId){const s=t(v).find(i=>i.id===t(a).parentTaskId),n=s==null?void 0:s.subtasks.find(i=>i.id===t(a).id);if(!n)return;e(w,n.id),e(yt,n.content),e(Et,n.status),e(xt,n.due_date),e(rt,null),e(F,null),e(k,null)}}}function ue(){e(k,null),e(gt,""),e(Wt,""),e(ht,null),e(qt,"open"),e(w,null),e(yt,""),e(xt,null),e(Et,"open")}async function je(){if(!t(k)||!t(gt).trim()||!E())return;e(Lt,!0);const{error:s}=await nt.from("tasks").update({title:t(gt).trim(),description:t(Wt).trim(),status:t(qt),due_date:t(ht)}).eq("id",t(k)).eq("owner_id",E().user.id);e(Lt,!1),s&&alert("Error saving task: "+s.message),await tt(),e(k,null)}function de(s,n){e(F,{taskId:s,index:n}),e(R,""),e(it,"open"),e(V,null),e(k,null),e(w,null),e(rt,null),e(M,new Set([...t(M),s]))}async function ce(s,n=null){if(!t(R).trim()||!E())return;e(ct,!0);const i=t(v).find(y=>y.id===s);if(!i)return;let p=i.subtasks.length;if(n!==null){p=n+1;const y=i.subtasks.slice(0,p),I=i.subtasks.slice(p),{data:W,error:ot}=await nt.from("subtasks").insert([{task_id:s,owner_id:E().user.id,content:t(R).trim(),status:t(it),due_date:t(V),sort_index:p}]).select();if(e(ct,!1),ot||!W||!W[0]){alert("Error creating subtask: "+((ot==null?void 0:ot.message)??"unknown")),await tt();return}const jt=W[0],Mt=[...y,jt,...I];await ee(s,Mt)}else{const{data:y,error:I}=await nt.from("subtasks").insert([{task_id:s,owner_id:E().user.id,content:t(R).trim(),status:t(it),due_date:t(V),sort_index:p}]).select();if(e(ct,!1),I||!y||!y[0]){alert("Error creating subtask: "+((I==null?void 0:I.message)??"unknown")),await tt();return}await tt()}e(R,""),e(it,"open"),e(V,null),e(F,null)}async function pe(s){if(!t(a)||t(a).type!=="subtask"||!t(a).parentTaskId)return;const n=t(v).find(W=>W.id===t(a).parentTaskId);if(!n)return;const i=n.subtasks.findIndex(W=>W.id===t(a).id);if(i===-1)return;const p=i+s;if(p<0||p>=n.subtasks.length)return;const y=[...n.subtasks],[I]=y.splice(i,1);y.splice(p,0,I),await ee(n.id,y),e(a,{type:"subtask",id:I.id,parentTaskId:n.id})}async function Me(){if(!t(w)||!t(yt).trim()||!E())return;e(Yt,!0);const{error:s}=await nt.from("subtasks").update({content:t(yt).trim(),status:t(Et),due_date:t(xt)}).eq("id",t(w)).eq("owner_id",E().user.id);e(Yt,!1),s&&alert("Error saving subtask: "+s.message),await tt(),e(w,null)}function ze(s){t(M).has(s)?e(M,new Set([...t(M)].filter(n=>n!==s))):e(M,new Set([...t(M),s]))}he(()=>Zt,()=>{_a(Zt,da(Zt))}),he(()=>E(),()=>{E(),tt()}),la(),ca();var ve=La(),Be=r(ft(ve),2);{var Ge=s=>{var n=Na(),i=ft(n),p=d(i);u(i);var y=r(i,4),I=d(y),W=r(I,2),ot=r(W,2),jt=r(ot,2),Mt=r(jt,2),_e=r(Mt,2);u(y);var Je=r(y,2);{var Ke=h=>{var b=ba();m(h,b)},Qe=h=>{var b=xe(),Rt=ft(b);{var Re=Ct=>{var At=fa(),ae=d(At,!0);u(At),C(()=>st(ae,t(Qt))),m(Ct,At)},Ue=Ct=>{var At=xe(),ae=ft(At);{var Ve=Pt=>{var zt=ma();m(Pt,zt)},Xe=Pt=>{var zt=Fa(),be=r(d(zt));Ie(be,5,()=>t(v),Te,(Ze,o,fe)=>{var me=Pa(),Bt=ft(me);let ge;var se=d(Bt),$e=d(se);{var ta=D=>{var T=ga(),A=d(T,!0);u(T),C((L,z)=>{re(T,"aria-label",L),st(A,z)},[()=>(t(M),t(o),c(()=>t(M).has(t(o).id)?"Collapse subtasks":"Expand subtasks")),()=>(t(M),t(o),c(()=>t(M).has(t(o).id)?"➖":"➕"))]),_("click",T,Ft(()=>ze(t(o).id))),m(D,T)};P($e,D=>{t(o),c(()=>t(o).subtasks.length>0)&&D(ta)})}u(se);var ne=r(se),ye=d(ne);u(ne);var ea=r(ne);{var aa=D=>{var T=ka(),A=d(T),L=d(A);Z(L);var z=r(L,2);Z(z);var Y=r(z,2);C(()=>{t(qt),Gt(()=>{})});var l=d(Y);l.value=l.__value="open";var B=r(l);B.value=B.__value="in_progress";var j=r(B);j.value=j.__value="done",u(Y);var q=r(Y,2);Z(q);var N=r(q,2);{var J=x=>{var pt=ya();_("click",pt,()=>e(ht,null)),m(x,pt)};P(N,x=>{t(ht)&&x(J)})}var et=r(N,2),X=r(et,2);u(A),u(T),C(x=>{et.disabled=x,X.disabled=t(Lt)},[()=>(t(Lt),t(gt),c(()=>t(Lt)||!t(gt).trim()))]),$(L,()=>t(gt),x=>e(gt,x)),$(z,()=>t(Wt),x=>e(Wt,x)),Kt(Y,()=>t(qt),x=>e(qt,x)),$(q,()=>t(ht),x=>e(ht,x)),_("click",X,ue),_("submit",A,Ht(je)),_("click",A,Ft(function(x){Jt.call(this,It,x)})),m(D,T)},sa=D=>{var T=wa(),A=ft(T),L=d(A,!0);u(A);var z=r(A,2),Y=d(z,!0);u(z);var l=r(z,2),B=d(l);{var j=q=>{var N=Se();C(J=>st(N,J),[()=>(t(o),c(()=>ie(t(o).due_date)))]),m(q,N)};P(B,q=>{t(o),c(()=>t(o).due_date)&&q(j)})}u(l),C(()=>{st(L,(t(o),c(()=>t(o).title))),st(Y,(t(o),c(()=>t(o).description)))}),m(D,T)};P(ea,D=>{t(k),t(o),c(()=>t(k)===t(o).id)?D(aa):D(sa,!1)})}u(Bt);var ke=r(Bt,2);{var na=D=>{var T=xa(),A=d(T),L=d(A),z=d(L);Z(z);var Y=r(z,2);Z(Y);var l=r(Y,2);C(()=>{t(wt),Gt(()=>{})});var B=d(l);B.value=B.__value="open";var j=r(B);j.value=j.__value="in_progress";var q=r(j);q.value=q.__value="done",u(l);var N=r(l,2);Z(N);var J=r(N,2);{var et=O=>{var vt=ha();_("click",vt,()=>e(mt,null)),m(O,vt)};P(J,O=>{t(mt)&&O(et)})}var X=r(J,2),x=d(X,!0);u(X);var pt=r(X,2);u(L),u(A),u(T),C(O=>{X.disabled=O,st(x,t(Dt)?"Adding…":"Insert Task")},[()=>(t(Dt),t(dt),c(()=>t(Dt)||!t(dt).trim()))]),$(z,()=>t(dt),O=>e(dt,O)),$(Y,()=>t(Tt),O=>e(Tt,O)),Kt(l,()=>t(wt),O=>e(wt,O)),$(N,()=>t(mt),O=>e(mt,O)),_("click",pt,()=>e(rt,null)),_("submit",L,Ht(()=>Pe(fe))),_("click",L,Ft(function(O){Jt.call(this,It,O)})),m(D,T)};P(ke,D=>{t(rt)===fe&&D(na)})}var ra=r(ke,2);{var ia=D=>{var T=Aa(),A=ft(T);Ie(A,1,()=>(t(o),c(()=>t(o).subtasks)),Te,(Y,l,B)=>{var j=Ea(),q=ft(j);let N;var J=r(d(q)),et=d(J);u(J);var X=r(J);{var x=K=>{var Q=Ia(),f=d(Q),G=d(f);Z(G);var at=r(G,2);C(()=>{t(Et),Gt(()=>{})});var lt=d(at);lt.value=lt.__value="open";var _t=r(lt);_t.value=_t.__value="in_progress";var ut=r(_t);ut.value=ut.__value="done",u(at);var bt=r(at,2);Z(bt);var kt=r(bt,2);{var Ut=H=>{var Xt=Sa();_("click",Xt,()=>e(xt,null)),m(H,Xt)};P(kt,H=>{t(xt)&&H(Ut)})}var Vt=r(kt,2),St=r(Vt,2);u(f),u(Q),C(H=>{Vt.disabled=H,St.disabled=t(Yt)},[()=>(t(Yt),t(yt),c(()=>t(Yt)||!t(yt).trim()))]),$(G,()=>t(yt),H=>e(yt,H)),Kt(at,()=>t(Et),H=>e(Et,H)),$(bt,()=>t(xt),H=>e(xt,H)),_("click",St,ue),_("submit",f,Ht(Me)),_("click",f,Ft(function(H){Jt.call(this,It,H)})),m(K,Q)},pt=K=>{var Q=Ta(),f=r(ft(Q),2),G=d(f,!0);u(f);var at=r(f,2),lt=d(at);{var _t=ut=>{var bt=Se();C(kt=>st(bt,kt),[()=>(t(l),c(()=>ie(t(l).due_date)))]),m(ut,bt)};P(lt,ut=>{t(l),c(()=>t(l).due_date)&&ut(_t)})}u(at),C(()=>st(G,(t(l),c(()=>t(l).content)))),m(K,Q)};P(X,K=>{t(w),t(l),c(()=>t(w)===t(l).id)?K(x):K(pt,!1)})}u(q);var O=r(q,2);{var vt=K=>{var Q=qa(),f=d(Q),G=d(f),at=d(G);Z(at);var lt=r(at,2);C(()=>{t(it),Gt(()=>{})});var _t=d(lt);_t.value=_t.__value="open";var ut=r(_t);ut.value=ut.__value="in_progress";var bt=r(ut);bt.value=bt.__value="done",u(lt);var kt=r(lt,2);Z(kt);var Ut=r(kt,2);{var Vt=U=>{var we=Da();_("click",we,()=>e(V,null)),m(U,we)};P(Ut,U=>{t(V)&&U(Vt)})}var St=r(Ut,2),H=d(St,!0);u(St);var Xt=r(St,2);u(G),u(f),u(Q),C(U=>{St.disabled=U,st(H,t(ct)?"Adding…":"Insert Subtask")},[()=>(t(ct),t(R),c(()=>t(ct)||!t(R).trim()))]),$(at,()=>t(R),U=>e(R,U)),Kt(lt,()=>t(it),U=>e(it,U)),$(kt,()=>t(V),U=>e(V,U)),_("click",Xt,()=>e(F,null)),_("submit",G,Ht(()=>ce(t(o).id,B))),_("click",G,Ft(function(U){Jt.call(this,It,U)})),m(K,Q)};P(O,K=>{t(F),t(o),c(()=>t(F)&&t(F).taskId===t(o).id&&t(F).index===B)&&K(vt)})}C((K,Q,f,G)=>{N=De(q,1,"subtask-row svelte-1d8c2g",null,N,K),qe(et,`background:${Q??""};
                    border-color:${f??""};`),re(et,"title",G)},[()=>({"selected-row":t(a)&&t(a).type==="subtask"&&t(a).id===t(l).id}),()=>(t(l),c(()=>oe(t(l).status,Ot(t(l).due_date,t(l).status)))),()=>(t(l),c(()=>Ot(t(l).due_date,t(l).status)?$t:"#aaa")),()=>(t(l),c(()=>t(l).status==="done"?"Done":Ot(t(l).due_date,t(l).status)?"Overdue":t(l).status==="open"?"Open":"In Progress"))]),_("click",q,()=>Le(t(l).id,t(o).id)),m(Y,j)});var L=r(A,2);{var z=Y=>{var l=Ca(),B=d(l),j=d(B),q=d(j);Z(q);var N=r(q,2);C(()=>{t(it),Gt(()=>{})});var J=d(N);J.value=J.__value="open";var et=r(J);et.value=et.__value="in_progress";var X=r(et);X.value=X.__value="done",u(N);var x=r(N,2);Z(x);var pt=r(x,2);{var O=f=>{var G=Oa();_("click",G,()=>e(V,null)),m(f,G)};P(pt,f=>{t(V)&&f(O)})}var vt=r(pt,2),K=d(vt,!0);u(vt);var Q=r(vt,2);u(j),u(B),u(l),C(f=>{vt.disabled=f,st(K,t(ct)?"Adding…":"Insert Subtask")},[()=>(t(ct),t(R),c(()=>t(ct)||!t(R).trim()))]),$(q,()=>t(R),f=>e(R,f)),Kt(N,()=>t(it),f=>e(it,f)),$(x,()=>t(V),f=>e(V,f)),_("click",Q,()=>e(F,null)),_("submit",j,Ht(()=>ce(t(o).id,t(o).subtasks.length-1))),_("click",j,Ft(function(f){Jt.call(this,It,f)})),m(Y,l)};P(L,Y=>{t(F),t(o),c(()=>t(F)&&t(F).taskId===t(o).id&&t(o).subtasks.length===0)&&Y(z)})}m(D,T)};P(ra,D=>{t(M),t(o),c(()=>t(M).has(t(o).id))&&D(ia)})}C((D,T,A,L)=>{ge=De(Bt,1,"svelte-1d8c2g",null,ge,D),qe(ye,`background:${T??""};
                border-color:${A??""};`),re(ye,"title",L)},[()=>({"selected-row":t(a)&&t(a).type==="task"&&t(a).id===t(o).id}),()=>(t(o),c(()=>oe(t(o).status,Ot(t(o).due_date,t(o).status)))),()=>(t(o),c(()=>Ot(t(o).due_date,t(o).status)?$t:"#aaa")),()=>(t(o),c(()=>t(o).status==="done"?"Done":Ot(t(o).due_date,t(o).status)?"Overdue":t(o).status==="open"?"Open":"In Progress"))]),_("click",Bt,()=>We(t(o).id)),m(Ze,me)}),u(be),u(zt),m(Pt,zt)};P(ae,Pt=>{t(v),c(()=>t(v).length===0)?Pt(Ve):Pt(Xe,!1)},!0)}m(Ct,At)};P(Rt,Ct=>{t(Qt)?Ct(Re):Ct(Ue,!1)},!0)}m(h,b)};P(Je,h=>{t(Nt)?h(Ke):h(Qe,!1)})}C((h,b)=>{st(p,`Logged in as ${E(),c(()=>E().user.email)??""}`),I.disabled=(t(a),t(k),t(w),c(()=>!t(a)||t(a).type==="task"&&t(k)!==null||t(a).type==="subtask"&&t(w)!==null)),W.disabled=(t(a),t(k),t(w),c(()=>!t(a)||t(a).type!=="task"||t(k)!==null||t(w)!==null)),ot.disabled=h,jt.disabled=b,Mt.disabled=(t(a),t(k),t(w),c(()=>!t(a)||t(a).type==="task"&&t(k)!==null||t(a).type==="subtask"&&t(w)!==null)),_e.disabled=(t(a),t(k),t(w),c(()=>!t(a)||t(a).type==="task"&&t(k)!==null||t(a).type==="subtask"&&t(w)!==null))},[()=>(t(a),t(k),t(v),t(w),c(()=>!t(a)||t(a).type==="task"&&(t(k)!==null||t(v).findIndex(h=>{var b;return h.id===((b=t(a))==null?void 0:b.id)})<=0)||t(a).type==="subtask"&&(t(w)!==null||!t(a).parentTaskId||(()=>{const h=t(v).find(b=>b.id===t(a).parentTaskId);return h?h.subtasks.findIndex(b=>b.id===t(a).id)<=0:!0})()))),()=>(t(a),t(k),t(v),t(w),c(()=>!t(a)||t(a).type==="task"&&(t(k)!==null||t(v).findIndex(h=>{var b;return h.id===((b=t(a))==null?void 0:b.id)})===t(v).length-1)||t(a).type==="subtask"&&(t(w)!==null||!t(a).parentTaskId||(()=>{const h=t(v).find(b=>b.id===t(a).parentTaskId);return h?h.subtasks.findIndex(b=>b.id===t(a).id)===h.subtasks.length-1:!0})())))]),_("click",I,()=>{var h;return t(a)&&t(a).type==="task"?Fe(t(v).findIndex(b=>{var Rt;return b.id===((Rt=t(a))==null?void 0:Rt.id)})):t(a)&&t(a).type==="subtask"&&t(a).parentTaskId?de(t(a).parentTaskId,((h=t(v).find(b=>b.id===t(a).parentTaskId))==null?void 0:h.subtasks.findIndex(b=>b.id===t(a).id))??-1):void 0}),_("click",W,()=>{var h;t(a)&&t(a).type==="task"&&de(t(a).id,((h=t(v).find(b=>b.id===t(a).id))==null?void 0:h.subtasks.length)-1)}),_("click",ot,()=>t(a)&&t(a).type==="task"?le(-1):t(a)&&t(a).type==="subtask"?pe(-1):void 0),_("click",jt,()=>t(a)&&t(a).type==="task"?le(1):t(a)&&t(a).type==="subtask"?pe(1):void 0),_("click",Mt,Ye),_("click",_e,Ne),m(s,n)},He=s=>{var n=Wa();m(s,n)};P(Be,s=>{E()?s(Ge):s(He,!1)})}m(Ee,ve),ua(),Ce()}export{Xa as component};
